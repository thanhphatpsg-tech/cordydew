name: Notify Telegram (Private)

on:
  push:
    branches:
      - "**"

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Telegram message
        env:
          BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: >
          REPO="${{ github.repository }}";
          BRANCH="${{ github.ref_name }}";
          ACTOR="${{ github.actor }}";
          COMMIT_MSG="${{ github.event.head_commit.message }}";
          COMMIT_URL="${{ github.event.head_commit.url }}";

          TEXT="$(printf 'GitHub Push\nRepo: %s\nBranch: %s\nBy: %s\nMessage: %s\n%s' "$REPO" "$BRANCH" "$ACTOR" "$COMMIT_MSG" "$COMMIT_URL")";

          curl -sS -X POST "https://api.telegram.org/bot${BOT_TOKEN}/sendMessage"
          -d "chat_id=${CHAT_ID}"
          --data-urlencode "text=${TEXT}";
